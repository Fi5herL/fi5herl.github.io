<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Docs Reader</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“–</text></svg>">
    <style>
        /* è®“ iframe å¡«æ»¿æ•´å€‹ç•«é¢ */
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }
    </style>
</head>
<body>
    <!-- iframe çš„ src æœƒç”±ä¸‹é¢çš„ JavaScript å‹•æ…‹è¨­å®š -->
    <iframe 
        id="gas-iframe" 
        src="" 
        title="Google Apps Script Content">
    </iframe>

    <script>
        // ã€æ ¸å¿ƒé‚è¼¯ã€‘
        (function() {
            // 1. é€™æ˜¯ä½ çš„ Google Apps Script éƒ¨ç½² URL (æ›¿æ›æˆä½ è‡ªå·±çš„)
            const gasWebAppUrl = "https://script.google.com/macros/s/AKfycbwsmyhtnE0B-y4lhPhNwXM4QMNpIP1704VK5hDpmIM8IrXUnhsmQcXJOPeaahzgoMb27w/exec";

            // 2. ç²å– iframe å…ƒç´ 
            const iframe = document.getElementById('gas-iframe');

            // 3. è§£æç•¶å‰ GitHub Pages çš„ç¶²å€åƒæ•¸
            const urlParams = new URLSearchParams(window.location.search);
            const docId = urlParams.get('docId');

            // 4. æ ¹æ“šæ˜¯å¦æœ‰ docId åƒæ•¸ï¼Œè¨­å®š iframe çš„ src
            if (docId) {
                // å¦‚æœç¶²å€æ˜¯ .../index.html?docId=xxx
                // å°±è®“ iframe è¼‰å…¥å¸¶æœ‰åŒæ¨£åƒæ•¸çš„ GAS ç¶²å€
                iframe.src = gasWebAppUrl + '?docId=' + docId;
            } else {
                // å¦‚æœç¶²å€åªæ˜¯ .../index.html
                // å°±è®“ iframe è¼‰å…¥ GAS çš„åŸºç¤ç¶²å€ (é¡¯ç¤ºåˆ—è¡¨)
                iframe.src = gasWebAppUrl;
            }
        })();
    </script>
</body>
</html>
